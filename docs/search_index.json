[["index.html", "应用非参数统计 背景", " 应用非参数统计 Huang 2021-07-29 背景 开始学习《应用非参数统计》，薛留根，科学出版社。居然没有豆瓣链接。 理论部分大多是手写笔记，这里主要记录一下R语言的的实现。 2021-6-22 "],["binom-test.html", "1 基于二项分布的检验 1.1 主要理论 1.2 习题3", " 1 基于二项分布的检验 1.1 主要理论 二项分布描述了n重Bernoulli试验种恰有k次成功的概率，记为\\(B(n,p)\\)，基于二项分布的检验主要是对\\(p\\)进行检验： \\[ H_0:\\ p=p_0\\qquad v.s. \\qquad H_1:\\ ? \\] 涉及到具体的实际问题主要有： 分位数检验：\\(X\\)的\\(p_0\\)分位数是\\(x_0\\)，数据中没有严格等于\\(x_0\\)的数 符号检验：\\(p_0=0.5\\)的二项检验。可用于中位数检验，两样本中成对数据的比较以及位置参数的检验 涉及到的主要R语言函数：binom.test。 formals(binom.test) #&gt; $x #&gt; #&gt; #&gt; $n #&gt; #&gt; #&gt; $p #&gt; [1] 0.5 #&gt; #&gt; $alternative #&gt; c(&quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot;) #&gt; #&gt; $conf.level #&gt; [1] 0.95 1.2 习题3 3.1 已知某中昆虫的20%显示出特性A，在非正常的环境下得到18条昆虫，其中没有一条具有特性A。那么假设在这种环境下，此种昆虫和通常环境一样有0.2的概率显示特性A，这合理吗？取显著性水平\\(\\alpha=0.05\\)，用双边检验。 解： 基于二项分布的检验问题： \\[ p=0.2\\qquad v.s.\\qquad p\\ne0.2 \\] 利用R： binom.test(x = 0,n = 18,p = 0.2,alternative = &quot;two.sided&quot;) #&gt; #&gt; Exact binomial test #&gt; #&gt; data: 0 and 18 #&gt; number of successes = 0, number of trials = 18, p-value = 0.03 #&gt; alternative hypothesis: true probability of success is not equal to 0.2 #&gt; 95 percent confidence interval: #&gt; 0.000 0.185 #&gt; sample estimates: #&gt; probability of success #&gt; 0 p值小于0.05，故应当拒绝原假设，即假设在这种环境下，此种昆虫和通常环境一样有0.2的概率显示特性A，这不合理。 3.2 在一次安全月活动中，所检验的16辆车中有6辆是不安全的。试在显著性水平\\(\\alpha=0.05\\)下，检验原假设：这些车中有不多于10%的车是安全的。 解： 设\\(p\\)是车辆不安全的概率，有基于二项分布的检验问题： \\[ p\\le0.1 \\qquad v.s. \\qquad p&gt;0.1 \\] 利用R： binom.test(x = 6,n = 16,p = 0.1,alternative = &quot;greater&quot;) #&gt; #&gt; Exact binomial test #&gt; #&gt; data: 6 and 16 #&gt; number of successes = 6, number of trials = 16, p-value = 0.003 #&gt; alternative hypothesis: true probability of success is greater than 0.1 #&gt; 95 percent confidence interval: #&gt; 0.178 1.000 #&gt; sample estimates: #&gt; probability of success #&gt; 0.375 \\(p\\)值小于0.05，应当拒绝原假设。 3.3 某一居民小区向市政府报告说，至少有60%的居民认同小区改造建设。市政府随后就随机调查了100个居民，其中48人同意这种小区改造建设。问在显著性水平\\(\\alpha=0.05\\)下，检验这个居民小区的报告是否合理。 解： 同意小区改造假设的居民人数服从二项分布，\\(p\\)为同意的概率。检验问题： \\[ p \\ge 0.6 \\qquad v.s. \\qquad p&lt;0.6 \\] 利用R： binom.test(x = 48,n = 100,p = 0.6,alternative = &quot;less&quot;) #&gt; #&gt; Exact binomial test #&gt; #&gt; data: 48 and 100 #&gt; number of successes = 48, number of trials = 100, p-value = 0.01 #&gt; alternative hypothesis: true probability of success is less than 0.6 #&gt; 95 percent confidence interval: #&gt; 0.000 0.567 #&gt; sample estimates: #&gt; probability of success #&gt; 0.48 \\(p\\)值小于0.05，故应当拒绝原假设，即认为这个居民小区的报告不合理。 3.4 据估计，目前做前列腺手术的男性中有一半正遭受某种副作用的影响。为了努力减轻这种副作用的可能性，FDA研究了一种新的手术方法。19例受手术者只有3人有这种不良副作用，由此得出这项新手术方法能有效减轻副作用，这个结论可靠吗？取显著性水平\\(\\alpha=0.05\\)。 解： 有不良副作用的受手术者人数服从二项分布，\\(p\\)为有不良副作用的概率，为了保护原假设，检验问题： \\[ p\\ge0.5\\qquad v.s. \\qquad p&lt;0.5 \\] 利用R： binom.test(x = 3,n = 19,p = 0.5,alternative = &quot;less&quot;) #&gt; #&gt; Exact binomial test #&gt; #&gt; data: 3 and 19 #&gt; number of successes = 3, number of trials = 19, p-value = 0.002 #&gt; alternative hypothesis: true probability of success is less than 0.5 #&gt; 95 percent confidence interval: #&gt; 0.000 0.359 #&gt; sample estimates: #&gt; probability of success #&gt; 0.158 \\(p\\)值小于0.05，即可以认为结论可靠。 3.5 某学校初中三年级学生的体重的随机样本有如下20个数据（单位：kg）： 71, 67, 49, 59.5, 65.5, 51.5, 77, 61, 46.5, 68.5, 43, 59.5, 80.5, 77, 79, 82.5, 40.5, 58.5, 64, 51.5. 试在显著性水平\\(\\alpha=0.05\\)下，检验下面的假设： （1）体重的中位数为51.5； （2）95%分位数至少是75； （3）30%分位数小于等于45。 解： # 先载入数据 data &lt;- c(71, 67, 49, 59.5, 65.5, 51.5, 77, 61, 46.5, 68.5, 43, 59.5, 80.5, 77, 79, 82.5, 40.5, 58.5, 64, 51.5) （1）利用符号检验 x &lt;- 51.5 S1 = sum(data&lt;x) # 小于中位数个数 S2 = sum(data&gt;x) # 大于中位数个数 S0 = sum(data==x) # 等于中位数个数 binom.test(x = S2,n = S1+S2,p = 0.5,alternative = &quot;two.side&quot;) # 去掉S0 #&gt; #&gt; Exact binomial test #&gt; #&gt; data: S2 and S1 + S2 #&gt; number of successes = 14, number of trials = 18, p-value = 0.03 #&gt; alternative hypothesis: true probability of success is not equal to 0.5 #&gt; 95 percent confidence interval: #&gt; 0.524 0.936 #&gt; sample estimates: #&gt; probability of success #&gt; 0.778 \\(p\\)值小于\\(0.05\\)，故应当拒绝假设（1）. （2）原假设等价于95%分位数大于等于75，也即若75是\\(p_0\\)分位数，则\\(p_0\\le0.95\\)。故检验问题为分位数检验： \\[ H_0:\\ p_0\\le0.95\\qquad v.s. \\qquad H_1:\\ p_0&gt;0.95 \\] x &lt;- 75 S1 = sum(data&lt;x) S2 = sum(data&gt;x) S0 = sum(data==x) S0 #&gt; [1] 0 由于没有数据严格等于75，可实用二项检验： binom.test(x = S1,n = S1+S2,p = 0.95,alternative = &quot;greater&quot;) #&gt; #&gt; Exact binomial test #&gt; #&gt; data: S1 and S1 + S2 #&gt; number of successes = 15, number of trials = 20, p-value = 1 #&gt; alternative hypothesis: true probability of success is greater than 0.95 #&gt; 95 percent confidence interval: #&gt; 0.544 1.000 #&gt; sample estimates: #&gt; probability of success #&gt; 0.75 \\(p\\)值很大，可以接受假设（2）. （3）类似于（2），可以得到分位数检验问题： \\[ H_0:\\ p_0\\ge0.3\\qquad v.s. \\qquad H_1:\\ p_0&lt;0.3 \\] x &lt;- 45 S1 = sum(data&lt;x) S2 = sum(data&gt;x) S0 = sum(data==x) S0 #&gt; [1] 0 由于没有数据严格等于45，可实用二项检验： binom.test(x = S1,n = S1+S2,p = 0.3,alternative = &quot;less&quot;) #&gt; #&gt; Exact binomial test #&gt; #&gt; data: S1 and S1 + S2 #&gt; number of successes = 2, number of trials = 20, p-value = 0.04 #&gt; alternative hypothesis: true probability of success is less than 0.3 #&gt; 95 percent confidence interval: #&gt; 0.000 0.283 #&gt; sample estimates: #&gt; probability of success #&gt; 0.1 \\(p\\)值小于\\(0.05\\)，应当拒绝假设（3）. 3.6 大学新生入学后需要参加一个特殊的高中学业考试，多年以来成绩的上四分位数是72.某高中有16名毕业生上了大学，他们参加了考试，得分如下： 70,92,73,60,81,63,92,68, 75,82,76,72,62,58,95,92 认为这16个学生是这所高中上大学的所有学生的一个随机样本。试在显著性水平\\(\\alpha=0.05\\)下，检验上面所给出的分数是来自一个上四分位数为72的总体。 解： 分位数的检验问题。设\\(X\\)为总体，检验问题： \\[ X的75\\%分位数为72\\quad v.s. \\quad X的75\\%分位数不是72 \\] 因为数据中有严格等于72的数据，所以下面考虑手动计算。 # d为数据向量 # q为分位数值 # p为多少分位数 quantile.test &lt;- function(d, q, p, alternative = c(&quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot;)){ len &lt;- length(d) t1 &lt;- sum(d&lt;=q) # 小于等于分位数值的个数 t2 &lt;- sum(d&lt;q) # 小于分位数值的个数 l &lt;- pbinom(q = t1,size = len,prob = p) r &lt;- pbinom(q = t2,size = len,prob = p,lower.tail = TRUE) PVAL &lt;- switch(alternative, less = l, greater = r, two.sided = 2*min(l,r)) structure(list(p.value = PVAL, alternative = alternative)) } d &lt;- c(70,92,73,60,81,63,92,68, 75,82,76,72,62,58,95,92 ) quantile.test(d,72,0.75,&quot;two.sided&quot;) #&gt; $p.value #&gt; [1] 0.00329 #&gt; #&gt; $alternative #&gt; [1] &quot;two.sided&quot; 由于\\(p\\)值小于0.05，故应当拒绝原假设。 3.7 在某保险种类中，2011年的索赔数额（单位：万元）的随机样本为 23.12, 23.64, 25.26, 27.42, 34.86, 37.98, 47.40, 52.37, 58.42, 63.71, 73.80, 75.06, 93.60, 98.25 已知2010年的索赔数额的中位数为48.32万元，试在显著性水平\\(\\alpha=0.05\\)下，检验2011年的索赔数额的中位数是否比上一年有所变化。 解： 中位数的双边检验问题，利用符号检验。 # 载入数据 d &lt;- c(23.12, 23.64, 25.26, 27.42, 34.86, 37.98, 47.40, 52.37, 58.42, 63.71, 73.80, 75.06, 93.60, 98.25) x &lt;- 48.32 S1 = sum(d&lt;x) S2 = sum(d&gt;x) S0 = sum(d==x) binom.test(x = S1,n = S1+S2,p = 0.5,alternative = &quot;two.sided&quot;) #&gt; #&gt; Exact binomial test #&gt; #&gt; data: S1 and S1 + S2 #&gt; number of successes = 7, number of trials = 14, p-value = 1 #&gt; alternative hypothesis: true probability of success is not equal to 0.5 #&gt; 95 percent confidence interval: #&gt; 0.23 0.77 #&gt; sample estimates: #&gt; probability of success #&gt; 0.5 \\(p\\)值巨大，可以认为原假设成立，即2011年的索赔数额的中位数比上一年没有显著变化。 3.8 一个工人加工某零件的尺寸标准应该是10mm，顺序度量了20个加工后的零件之后，得到如下尺寸： 9.9,8.8,11.3,10.3,10.0,10.5,11.6,9.4,11.9,9.4, 9.5,11.7,12.2,9.6,12.8,9.8,10.7,10.9,11.3,10.7 试在显著性水平\\(\\alpha=0.05\\)下，检验零件尺寸的中位数是否有大于10mm的可能？ 解： 中位数检验问题： \\[ M&gt;10\\qquad v.s. \\qquad M\\le 10 \\] # 载入数据 d &lt;- c(29.9,8.8,11.3,10.3,10.0,10.5,11.6,9.4,11.9,9.4, 9.5,11.7,12.2,9.6,12.8,9.8,10.7,10.9,11.3,10.7) x &lt;- 10 S1 = sum(d&lt;x) S2 = sum(d&gt;x) S0 = sum(d==x) binom.test(x = S1,n = S1+S2,p = 0.5,alternative = &quot;less&quot;) #&gt; #&gt; Exact binomial test #&gt; #&gt; data: S1 and S1 + S2 #&gt; number of successes = 6, number of trials = 19, p-value = 0.08 #&gt; alternative hypothesis: true probability of success is less than 0.5 #&gt; 95 percent confidence interval: #&gt; 0.00 0.53 #&gt; sample estimates: #&gt; probability of success #&gt; 0.316 \\(p\\)值大于0.05，应当接受原假设，即认为零件尺寸的中位数有大于10mm的可能。 3.9 关顾某食品店的22名顾客品尝甲和乙两种点心并选出喜欢的品种。7名顾客喜欢甲品种，12顾客喜欢乙品种，3名顾客没有特别偏好。问在显著性水平\\(\\alpha=0.05\\)下，这能否说明顾客有明显偏好？ 解： 成对数据的比较，利用两样本的符号检验： \\[ 顾客没有明显偏好\\qquad v.s. \\qquad 顾客没有明显偏好 \\] S1 = 7 # 喜欢甲品种 S2 = 12 # 喜欢乙品种 S0 = 3 # 结点，不考虑 binom.test(x = S1,n = S1+S2,p = 0.5,alternative = &quot;two.sided&quot;) #&gt; #&gt; Exact binomial test #&gt; #&gt; data: S1 and S1 + S2 #&gt; number of successes = 7, number of trials = 19, p-value = 0.4 #&gt; alternative hypothesis: true probability of success is not equal to 0.5 #&gt; 95 percent confidence interval: #&gt; 0.163 0.616 #&gt; sample estimates: #&gt; probability of success #&gt; 0.368 \\(p\\)值大于0.05，故应当接受原假设，即认为顾客有明显偏好。 3.10 某6位学生打算通过节食减肥，节食前后的体重（单位：kg）有如下结果： 节食前体重：114,121,128,122,141,128 节食后体重：105,126,123,118,143,121 问在显著性水平\\(\\alpha=0.05\\)下，我们能否认为他们的减肥计划是成功的？ 解： 成对数据的比较问题： \\[ P^{-}&gt; P^{+}\\qquad v.s. \\qquad P^{-}\\le P^{+} \\] 即 \\[ P^{-}&gt; 0.5\\qquad v.s. \\qquad P^{-}\\le 0.5 \\] # 载入数据 d1 &lt;- c(114,121,128,122,141,128) d2 &lt;- c(105,126,123,118,143,121) S1 &lt;- sum(d2&lt;d1) # S- S2 &lt;- sum(d2&gt;d1) # S+ binom.test(x = S1,n = S1+S2,p = 0.5,alternative = &quot;less&quot;) #&gt; #&gt; Exact binomial test #&gt; #&gt; data: S1 and S1 + S2 #&gt; number of successes = 4, number of trials = 6, p-value = 0.9 #&gt; alternative hypothesis: true probability of success is less than 0.5 #&gt; 95 percent confidence interval: #&gt; 0.000 0.937 #&gt; sample estimates: #&gt; probability of success #&gt; 0.667 \\(p\\)值大于0.05，故我们应当接受原假设，即认为他们的减肥计划并不成功。 "],["chisq-test.html", "2 列联分析 2.1 主要理论 2.2 习题4", " 2 列联分析 2.1 主要理论 对于二维列联表： 拟合优度检验：样本是从总体的不同类别中分别抽取，研究不同类别的目标量之间是否存在显著性差异。 独立性检验：两个变量间是否存在联系。 两者都是利用Pearson \\(\\chi^2\\)统计量，在R中使用函数chisq.test。 chisq.test(x, y = NULL, correct = TRUE, p = rep(1/length(x), length(x)), rescale.p = FALSE, simulate.p.value = FALSE, B = 2000) 用法参考：https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/chisq.test 。主要用法为将列联表矩阵赋予参数x。 使用注意： 要求样本量必须足够大，特别是每个单元中的期望频数不能过小。一般需要满足两个准则： 如果只有两个单元，每个单元的期望频数必须大于等于5.在2x2列联表中，有一个期望值小于5且样本量小于40，或几个期望值小于5，或有一个期望值小于1，均不宜作\\(\\chi^2\\)检验。 有两个以上的单元，20%的单元期望频数小于5，不能应用\\(\\chi^2\\)检验。 对于三维列联表： 独立性检验：建立对数线性模型。 利用MASS包的loglin()函数，用法详见：https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/loglin 。主要用法为： # a为一个三维数组 loglin(a,list(1,2,3)) # 检验X Y Z独立性 loglin(a,list(1,c(2,3))) # 检验X与（Y Z）独立性 loglin(a,list(c(1,2),c(1,3))) # 检验(X Y)(X Z)独立性，即给定X检验Y Z独立性 并且可以计算Pearson统计量以及LRT统计量，当值较大时拒绝原假设（独立）。 2.2 习题4 4.1 从两台机器生产的产品中随机抽样，来检查两台机器生产的产品次品率是否有差异，列联表如下： 次品 正品 合计 机器1 12 88 100 机器2 16 74 90 合计 28 162 190 试在显著性水平\\(\\alpha=0.05\\)下，检验两台机器生产的产品次品率是否有差异？ 解： 二维列联表的拟合优度检验。 x &lt;- c(12,88,16,74) x &lt;- matrix(x,2,2,byrow = TRUE) chisq.test(x) #&gt; #&gt; Pearson&#39;s Chi-squared test with Yates&#39; continuity correction #&gt; #&gt; data: x #&gt; X-squared = 0.8, df = 1, p-value = 0.4 \\(p\\)值大于0.05，应当接受原假设，即认为两台机器生产的产品次品率没有差异。 4.2 赞成该方案 反对该方案 合计 一分公司 68 32 100 二分公司 75 45 120 三分公司 57 33 90 四分公司 79 31 100 合计 279 141 420 试在显著性水平\\(\\alpha=0.1\\)下，检验四个分公司对改革方案的赞成比例是否一致。 解： 二维列联表的拟合优度检验。 x &lt;- c(68,75,57,79,32,45,33,31) x &lt;- matrix(x,4,2) chisq.test(x) #&gt; #&gt; Pearson&#39;s Chi-squared test #&gt; #&gt; data: x #&gt; X-squared = 3, df = 3, p-value = 0.4 \\(p\\)值大于0.1，应当接受原假设，即认为四个分公司对改革方案的赞成比例一致。 4.3 小于等于30（岁） 31-50（岁） &gt;50（岁） 合计 体育类 83 91 41 215 电视剧类 70 86 38 194 综艺类 45 15 10 70 合计 198 192 89 479 试在显著性水平\\(\\alpha=0.05\\)下，检验不同观众对三类节目的关注率是否一样。 解： 二维列联表的拟合优度检验。 x &lt;- c(83,70,45,91,86,15,41,38,10) x &lt;- matrix(x,3,3) chisq.test(x) #&gt; #&gt; Pearson&#39;s Chi-squared test #&gt; #&gt; data: x #&gt; X-squared = 19, df = 4, p-value = 9e-04 \\(p\\)值小于0.05，应当拒绝原假设，即认为不同观众对三类节目的关注率不一样。 4.4 得肺癌 未得肺癌 合计 抽烟 8 19 27 未抽烟 1 17 18 合计 9 36 45 试在显著性水平\\(\\alpha=0.05\\)下，检验抽烟对得肺癌是否有显著影响。 解： 利用\\(\\chi^2\\)检验，一时间分不清是拟合优度检验还是独立性检验。。 先进行\\(\\chi^2\\)分布的期望值准则验证。 # 输入二维列联表矩阵 # 返回值： # n 总和 # expectation 期望频数矩阵 # rule 是否满足准则 chisq.expectation &lt;- function(x){ res &lt;- list() r &lt;- nrow(x) c &lt;- ncol(x) rs &lt;- apply(x,1,sum) # 每行求和 cs &lt;- apply(x,2,sum) # 每列求和 as &lt;- sum(x) # 总和 res$n &lt;- as res$expectation &lt;- rs%*%t(cs)/as # 期望频数矩阵 if(r==2&amp;c==1|r==1&amp;c==2){ res$rule &lt;- !sum(res$expectation&lt;5) }else if(r==2&amp;c==2){ if(sum(res$expectation&lt;5)==1&amp;as&lt;40){res$rule &lt;-FALSE} else if(sum(res$expectation&lt;5)&gt;1|sum(res$expectation&lt;1)&gt;0) {res$rule &lt;-FALSE} else {res$rule &lt;-TRUE} }else{ res$rule &lt;- (mean(res$expectation&lt;5)&lt;0.2) } res } chisq.expectation(x) #&gt; $n #&gt; [1] 479 #&gt; #&gt; $expectation #&gt; [,1] [,2] [,3] #&gt; [1,] 88.9 86.2 39.9 #&gt; [2,] 80.2 77.8 36.0 #&gt; [3,] 28.9 28.1 13.0 #&gt; #&gt; $rule #&gt; [1] TRUE 满足准则。 x &lt;- c(8,1,19,17) x &lt;- matrix(x,2,2) chisq.test(x) #&gt; Warning in chisq.test(x): Chi-squared approximation may be incorrect #&gt; #&gt; Pearson&#39;s Chi-squared test with Yates&#39; continuity correction #&gt; #&gt; data: x #&gt; X-squared = 3, df = 1, p-value = 0.1 \\(p\\)值大于0.05，应当接受原假设，即认为抽烟对得肺癌没有显著影响。 4.5 肝炎 肝硬化 对照（非肝病患者） 合计 O型 98 38 289 425 A型 67 41 262 370 B型 13 8 57 78 AB型 18 12 30 60 合计 196 99 638 933 试在显著性水平\\(\\alpha=0.05\\)下，检验血型与肝病之间是否存在关联。 解： 先进行\\(\\chi^2\\)分布的期望值准则检验。 x &lt;- c(98,67,13,18,38,41,8,12,289,262,57,30) x &lt;- matrix(x,4,3) x #&gt; [,1] [,2] [,3] #&gt; [1,] 98 38 289 #&gt; [2,] 67 41 262 #&gt; [3,] 13 8 57 #&gt; [4,] 18 12 30 chisq.expectation(x) #&gt; $n #&gt; [1] 933 #&gt; #&gt; $expectation #&gt; [,1] [,2] [,3] #&gt; [1,] 89.3 45.10 290.6 #&gt; [2,] 77.7 39.26 253.0 #&gt; [3,] 16.4 8.28 53.3 #&gt; [4,] 12.6 6.37 41.0 #&gt; #&gt; $rule #&gt; [1] TRUE 满足准则，进行独立性检验。 chisq.test(x) #&gt; #&gt; Pearson&#39;s Chi-squared test #&gt; #&gt; data: x #&gt; X-squared = 15, df = 6, p-value = 0.02 \\(p\\)值小于0.05，应当拒绝原假设，即认为血型与肝病之间存在关联。 4.6 A、B、C是候选学生，列联表展示了各学院投票情况： A B C 合计 一学院 24 23 12 59 二学院 24 14 10 48 三学院 17 8 13 38 四学院 27 19 9 55 合计 92 64 44 200 问在显著性水平\\(\\alpha=0.01\\)下，我们能否认为投票结果与投票者在什么学院相互独立？ 解： 先进行\\(\\chi^2\\)分布的期望值准则检验。 x &lt;- c(24,24,17,27,23,14,8,19,12,10,13,9) x &lt;- matrix(x,4,3) chisq.expectation(x) #&gt; $n #&gt; [1] 200 #&gt; #&gt; $expectation #&gt; [,1] [,2] [,3] #&gt; [1,] 27.1 18.9 12.98 #&gt; [2,] 22.1 15.4 10.56 #&gt; [3,] 17.5 12.2 8.36 #&gt; [4,] 25.3 17.6 12.10 #&gt; #&gt; $rule #&gt; [1] TRUE 满足准则，下面进行独立性检验： chisq.test(x) #&gt; #&gt; Pearson&#39;s Chi-squared test #&gt; #&gt; data: x #&gt; X-squared = 7, df = 6, p-value = 0.4 \\(p\\)值大于0.05，应当接受原假设，即认为投票结果与投票者在什么学院相互独立。 4.7 2x2x2列联表，三个变量分别为护士衣着颜色（X）、儿童性别（Y）、护士性别（Z）。 护士性别 女： 护士衣着颜色/儿童性别 女 男 花衣 36 8 白衣 12 4 护士性别 男： 护士衣着颜色/儿童性别 女 男 花衣 25 13 白衣 1 0 试在显著性水平\\(\\alpha=0.01\\)下，检验这三个变量之间哪些是独立的，哪些是不独立的。 解： 三维列联表的独立性检验： x &lt;- c(36,12,8,4,25,1,13,0) x &lt;- array(x,c(2,2,2)) # 转为三维数组 loglin(x,list(1,2,3)) #&gt; 2 iterations: deviation 1.42e-14 #&gt; $lrt #&gt; [1] 15.3 #&gt; #&gt; $pearson #&gt; [1] 12.6 #&gt; #&gt; $df #&gt; [1] 4 #&gt; #&gt; $margin #&gt; $margin[[1]] #&gt; [1] 1 #&gt; #&gt; $margin[[2]] #&gt; [1] 2 #&gt; #&gt; $margin[[3]] #&gt; [1] 3 library(tidyverse) #&gt; -- Attaching packages ------------------ #&gt;  ggplot2 3.3.2  purrr 0.3.4 #&gt;  tibble 3.0.3  dplyr 1.0.2 #&gt;  tidyr 1.1.1  stringr 1.4.0 #&gt;  readr 1.3.1  forcats 0.5.0 #&gt; -- Conflicts -- tidyverse_conflicts() -- #&gt; x dplyr::filter() masks stats::filter() #&gt; x dplyr::lag() masks stats::lag() iterfun &lt;- function(l){ x &lt;- c(36,12,8,4,25,1,13,0) x &lt;- array(x,c(2,2,2)) loglin(x,margin = l,print = FALSE)[1:3] } models &lt;- list(list(1,2,3),list(1,c(2,3)),list(2,c(1,3)),list(3,c(1,2)), list(c(1,2),c(1,3)),list(c(2,1),c(2,3)),list(c(1,3),c(2,3))) models_name &lt;- c(&quot;(X,Y,Z)&quot;,&quot;(X,YZ)&quot;,&quot;(Y,XZ)&quot;,&quot;(Z,XY)&quot;,&quot;(XY,XZ)&quot;,&quot;(XY,YZ)&quot;,&quot;(XZ,YZ)&quot;) df &lt;- map(models,iterfun) %&gt;% # 对所有模型应用loglin函数 unlist() %&gt;% matrix(ncol = 3,byrow = TRUE) %&gt;% as_tibble() %&gt;% # 转为tibble rename(lrt=V1,pearson=V2,df=V3) %&gt;% # 重命名 mutate(models=models_name) %&gt;% # 加入对应模型名称 select(models,everything()) %&gt;% # 调整列顺序 mutate(cv = qchisq(1-0.01,df)) %&gt;% # 计算显著性水平为0.01的临界值 mutate(lrt_test=(lrt&gt;cv),pearson_test=(pearson&gt;cv)) # 检验结果，是否接受原假设 #&gt; Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0. #&gt; Using compatibility `.name_repair`. #&gt; This warning is displayed once every 8 hours. #&gt; Call `lifecycle::last_warnings()` to see where this warning was generated. knitr::kable(df,digits = 3) models lrt pearson df cv lrt_test pearson_test (X,Y,Z) 15.26 12.638 4 13.28 TRUE FALSE (X,YZ) 13.06 10.213 3 11.35 TRUE FALSE (Y,XZ) 3.35 3.119 3 11.35 FALSE FALSE (Z,XY) 15.22 12.594 3 11.35 TRUE TRUE (XY,XZ) 3.31 3.077 2 9.21 FALSE FALSE (XY,YZ) 13.03 10.370 2 9.21 TRUE TRUE (XZ,YZ) 1.15 0.854 2 9.21 FALSE FALSE 其中lrt_test,pearson_test表示lrt统计量跟pearson统计量的检验结果是否接受原假设（变量独立），可以看到两者有时并非一致的。 4.8 2x2x3列联表，三个变量分别为近视与否（X）、学生性别（Y）、学校（Z）。 学校 甲： 近视与否/学生性别 男 女 近视 55 58 不近视 45 41 学校 乙： 近视与否/学生性别 男 女 近视 66 85 不近视 87 70 学校 丙： 近视与否/学生性别 男 女 近视 66 50 不近视 41 39 试在显著性水平\\(\\alpha=0.01\\)下检验哪些变量独立，哪些不独立。 解： 仿照上一题做法。 library(tidyverse) iterfun &lt;- function(l){ x &lt;- c(55,45,58,41,66,87,85,70,66,41,50,39) x &lt;- array(x,c(2,2,3)) loglin(x,margin = l,print = FALSE)[1:3] } models &lt;- list(list(1,2,3),list(1,c(2,3)),list(2,c(1,3)),list(3,c(1,2)), list(c(1,2),c(1,3)),list(c(2,1),c(2,3)),list(c(1,3),c(2,3))) models_name &lt;- c(&quot;(X,Y,Z)&quot;,&quot;(X,YZ)&quot;,&quot;(Y,XZ)&quot;,&quot;(Z,XY)&quot;,&quot;(XY,XZ)&quot;,&quot;(XY,YZ)&quot;,&quot;(XZ,YZ)&quot;) df &lt;- map(models,iterfun) %&gt;% # 对所有模型应用loglin函数 unlist() %&gt;% matrix(ncol = 3,byrow = TRUE) %&gt;% as_tibble() %&gt;% # 转为tibble rename(lrt=V1,pearson=V2,df=V3) %&gt;% # 重命名 mutate(models=models_name) %&gt;% # 加入对应模型名称 select(models,everything()) %&gt;% # 调整列顺序 mutate(cv = qchisq(1-0.01,df)) %&gt;% # 计算显著性水平为0.01的临界值 mutate(lrt_test=(lrt&gt;cv),pearson_test=(pearson&gt;cv)) # 检验结果，是否接受原假设 knitr::kable(df,digits = 3) models lrt pearson df cv lrt_test pearson_test (X,Y,Z) 12.18 12.12 7 18.5 FALSE FALSE (X,YZ) 10.91 10.90 5 15.1 FALSE FALSE (Y,XZ) 6.36 6.35 5 15.1 FALSE FALSE (Z,XY) 10.85 10.93 6 16.8 FALSE FALSE (XY,XZ) 5.04 5.03 4 13.3 FALSE FALSE (XY,YZ) 9.59 9.54 4 13.3 FALSE FALSE (XZ,YZ) 5.10 5.09 3 11.3 FALSE FALSE 好像…所有变量组合都不独立… "],["rank-test.html", "3 秩检验 3.1 主要理论 3.2 函数实现 3.3 函数测试 3.4 习题5", " 3 秩检验 3.1 主要理论 线性秩统计量：定义、基本性质 符号秩统计量：定义、基本性质，Wilcoxon符号秩检验（对称中心检验、成对数据检验）wilcox.test(paired = TRUE) 位置参数的检验：Wilcoxon秩和检验wilcox.test(paired = FALSE)，Mann-Witney检验（统计量与Wilcoxon秩和统计量等价） 尺度参数的检验：Mood检验mood.test、平方秩检验 多个独立样本问题：Kruskal-Waillis检验kruskal.test、Dunn检验DunnTest（DescTools包，当Kruskal-Waillis检验拒绝原假设）、Jonckheere-Terpstra检验JonckheereTerpstraTest（DescTools包）、 区组设计：Friedman检验friedman.test、Page检验、Cochran检验、Duribn检验durbin.test（PMCMRplus包） 相关分析：Spearman秩相关分析、Kendall \\(\\tau\\) 相关检验cor.test、多变量Kendall协同系数检验KendallW（DescTools包） 线性回归的非参数方法cor.test 3.2 函数实现 将上述提到的平方秩检验，Page检验，Cochran检验进行编码实现。 3.2.1 平方秩检验 # 平方秩检验 # 输入： # x,y:两总体样本向量 # alternative:备择假设方向 square_rank.test &lt;- function(x, y, alternative = c(&quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot;)) { if(!is.vector(x)||!is.vector(y)){ stop(&quot;&#39;x&#39; and &#39;y&#39; must be vector&quot;) } n1 &lt;- length(x); n2 &lt;- length(y); n &lt;- n1+n2; mx &lt;- mean(x); my &lt;- mean(y); U &lt;- abs(x-mx); V &lt;- abs(y-my); # 绝对离差 r &lt;- rank(c(U,V),ties.method = &quot;average&quot;) # 混合离差秩 T &lt;- sum(r[1:n1]^2) # 相应于U的秩平方和 z &lt;- (T-n2*(n+1)*(2*n+1)/6)/sqrt(n1*n2*(n+1)*(2*n+1)*(8*n+11)/180) pl &lt;- pnorm(z) pr &lt;- pnorm(z,lower.tail = FALSE) Twarning &lt;- (n1&lt;=10|n2&lt;=10) # 样本数过小的提醒 s &lt;- &quot;&quot; # 如果打结 if(length(unique(r))!=n){ mrs &lt;- mean(r^2) s2 &lt;- n1*n2*sum(r^4)/(n*(n-1))-n1*n2*mrs^2/(n-1) T &lt;- (T-n1*mrs)/sqrt(s2) # 调整T pl &lt;- pnorm(T) pr &lt;- pnorm(T,lower.tail = FALSE) Twarning &lt;- FALSE s &lt;- &quot;(with ties)&quot; } # p值 PVAL &lt;- switch(alternative, less = pl, greater = pr, two.sided = 2*min(pl,pr)) names(T) &lt;- &quot;square rank test statistic&quot; names(n1) &lt;- &quot;the number of x&quot; names(n2) &lt;- &quot;the number of y&quot; names(n) &lt;- &quot;the number of x and y&quot; l &lt;- list(statistic = T, parameter = c(n1,n2,n), p.value = PVAL, alternative = alternative, method = paste(&quot;Square rank test&quot;,s), data.name = paste(deparse(substitute(x)),&quot;and&quot;,deparse(substitute(y)))) if(Twarning){ warning(&quot;The sizes of x and y are less than 10. The test may be inaccurate.&quot;) } structure(l, class = &quot;htest&quot;) } 测试一下： x &lt;- c(74,75,76,79,82,65,86,58) y &lt;- c(72,73,69,74,68,75,67,76,66) square_rank.test(x,y,alternative = &quot;two.sided&quot;) #&gt; Warning in square_rank.test(x, y, alternative = &quot;two.sided&quot;): The sizes of x and #&gt; y are less than 10. The test may be inaccurate. #&gt; #&gt; Square rank test #&gt; #&gt; data: x and y #&gt; square rank test statistic = 1108, the number of x = 8, the number of y #&gt; = 9, the number of x and y = 17, p-value = 0.4 #&gt; alternative hypothesis: two.sided 3.2.2 Page检验 备择假设为单调趋势。 # page检验 # 输入： # x:区组设计矩阵，行处理，列区组 # alternative:备择假设，up为单调上升，down为单调下降 page.test &lt;- function(x, alternative = c(&quot;increasing&quot;,&quot;decreasing&quot;)) { if(!is.matrix(x)){ stop(&quot;&#39;x&#39; must be matrix&quot;) } k &lt;- nrow(x) # 行数，处理 b &lt;- ncol(x) # 列数，区组 r &lt;- apply(x, 2, rank) # 按列求秩 R &lt;- apply(r,1,sum) # 按行求和 L &lt;- sum((1:k)*R) # Page检验统计量 # 求标准差 t &lt;- unlist(apply(x,2,table)) g &lt;- sum(t^3-t) # 打结修正量 sigma2 &lt;- k*(k+1)*(b*k*(k^2-1)-g)/144 z &lt;- (L-b*k*(k+1)^2/4)/sqrt(sigma2) # p值 PVAL &lt;- switch(alternative, increasing = pnorm(z,lower.tail = FALSE), decreasing = pnorm(z)) names(L) &lt;- &quot;Page test statistic&quot; l &lt;- list(statistic = L, parameter = list(blocks=b,treatments=k), p.value = PVAL, alternative = alternative, method = &quot;Page test&quot;, data.name = paste(deparse(substitute(x)))) structure(l, class = &quot;htest&quot;) } 3.2.3 Cochran检验 只取二元数据的完全区组设计的假设检验问题。 # Cochran检验 # 输入：x为bool矩阵，行为处理 cochran.test &lt;- function(x) { if(!is.matrix(x)||!is.logical(x)){ stop(&quot;&#39;x&#39; must be a logical matrix&quot;) } k &lt;- nrow(x) # 行数，处理 b &lt;- ncol(x) # 列数，区组 Ni &lt;- apply(x, 1, sum) # 行和 Lj &lt;- apply(x, 2, sum) # 列和 N &lt;- sum(x) # 总和 Q &lt;- (k*(k-1)^2*var(Ni))/(k*N-sum(Lj^2)) # 检验统计量 # p值 PVAL &lt;- pchisq(Q,k-1,lower.tail = FALSE) names(Q) &lt;- &quot;Cochran test statistic&quot; l &lt;- list(statistic = Q, parameter = list(df=k-1,blocks=b,treatments=k), p.value = PVAL, method = &quot;Cochran test&quot;, data.name = deparse(substitute(x))) structure(l, class = &quot;htest&quot;) } 3.3 函数测试 对课本上的一些例子使用上述函数进行测试。先载入相关包： library(DescTools) library(PMCMRplus) 例5.2.2 Wilcoxon符号秩检验： x &lt;- c(34.3,35.8,35.4,34.8,35.2,35.1,35.0,35.5)-35 wilcox.test(x,alternative = &quot;greater&quot;,mu=0,exact = FALSE) #&gt; #&gt; Wilcoxon signed rank test with continuity correction #&gt; #&gt; data: x #&gt; V = 20, p-value = 0.2 #&gt; alternative hypothesis: true location is greater than 0 例5.2.3 Wilcoxon符号秩检验： x &lt;- c(42,51,31,61,44,55,48) y &lt;- c(38,53,36,52,33,49,36) wilcox.test(x,y,mu = 0,alternative = &quot;greater&quot;,paired = TRUE) #&gt; #&gt; Wilcoxon signed rank test #&gt; #&gt; data: x and y #&gt; V = 24, p-value = 0.05 #&gt; alternative hypothesis: true location shift is greater than 0 例5.3.1 Wilcoxon秩和检验： x &lt;- c(1.20,1.63,2.26,1.87,2.20,1.30) y &lt;- c(0.94,1.26,1.15) wilcox.test(x,y,mu = 0,alternative = &quot;greater&quot;,paired = FALSE) #&gt; #&gt; Wilcoxon rank sum test #&gt; #&gt; data: x and y #&gt; W = 17, p-value = 0.02 #&gt; alternative hypothesis: true location shift is greater than 0 例5.4.1 Mood检验： x &lt;- c(4.5,6.5,7.0,10.0,12.0) y &lt;- c(6.0,7.2,8.0,9.0,9.8) mood.test(x,y,alternative = &quot;two.sided&quot;) #&gt; #&gt; Mood two-sample test of scale #&gt; #&gt; data: x and y #&gt; Z = 2, p-value = 0.1 #&gt; alternative hypothesis: two.sided 例5.4.2 平方秩检验： x &lt;- c(74,74,76,79,82,65,86,58) y &lt;- c(72,73,69,74,68,75,67,76,66) square_rank.test(x,y,alternative = &quot;two.sided&quot;) #&gt; #&gt; Square rank test (with ties) #&gt; #&gt; data: x and y #&gt; square rank test statistic = 1, the number of x = 8, the number of y = #&gt; 9, the number of x and y = 17, p-value = 0.2 #&gt; alternative hypothesis: two.sided 例5.5.1 kruskal检验： A &lt;- c(73,64,67,62,70) B &lt;- c(84,80,81,77) C &lt;- c(82,79,71,75) x &lt;- list(A,B,C) kruskal.test(x) #&gt; #&gt; Kruskal-Wallis rank sum test #&gt; #&gt; data: x #&gt; Kruskal-Wallis chi-squared = 8, df = 2, p-value = 0.01 这里课本的\\(p\\)值好像有误。 Dunn检验进行两两比较： DunnTest(x) #&gt; #&gt; Dunn&#39;s test of multiple comparisons using rank sums : holm #&gt; #&gt; mean.rank.diff pval #&gt; 2-1 7.30 0.0156 * #&gt; 3-1 5.05 0.1065 #&gt; 3-2 -2.25 0.4139 #&gt; --- #&gt; Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 例5.5.2 Jonckheere-Terpstra检验： # 先构建列表 A &lt;- c(260,200,240,170,270,205,190,200,250,200) B &lt;- c(310,310,190,225,170,210,280,210,280,240) C &lt;- c(225,260,360,310,270,380,240,295,260,250) x &lt;- list(A,B,C) JonckheereTerpstraTest(x,alternative = &quot;increasing&quot;) #&gt; Error in JonckheereTerpstraTest.default(x, alternative = &quot;increasing&quot;): group should be numeric or ordered factor 不知道为什么会报错，查了一下源代码，原因是当参数只给x作为一个列表时，会自动计算g，但是计算出来的g的一个无序的factor，下面的运算都需要g是一个有序的factor，不知道是不是代码的问题。 现手动计算g传入参数： k &lt;- length(x) l &lt;- sapply(x,length) g &lt;-ordered(rep(1:k, l)) x &lt;- unlist(x) JonckheereTerpstraTest(x,g,alternative = &quot;increasing&quot;) #&gt; Warning in JonckheereTerpstraTest.default(x, g, alternative = &quot;increasing&quot;): Sample size &gt; 100 or data with ties #&gt; p-value based on normal approximation. Specify nperm for permutation p-value #&gt; #&gt; Jonckheere-Terpstra test #&gt; #&gt; data: x and g #&gt; JT = 224, p-value = 0.002 #&gt; alternative hypothesis: increasing 例5.6.1 Friedman检验： # 先构建矩阵：行为区组，列为处理 # 每个处理的数据 A &lt;- c(14,19,17,17,16,15,18,16) B &lt;- c(23,25,22,21,24,26,26,22) C &lt;- c(26,25,29,28,28,27,27,30) D &lt;- c(30,33,28,27,32,26,36,32) y &lt;- matrix(c(A,B,C,D),ncol = 4) y #&gt; [,1] [,2] [,3] [,4] #&gt; [1,] 14 23 26 30 #&gt; [2,] 19 25 25 33 #&gt; [3,] 17 22 29 28 #&gt; [4,] 17 21 28 27 #&gt; [5,] 16 24 28 32 #&gt; [6,] 15 26 27 26 #&gt; [7,] 18 26 27 36 #&gt; [8,] 16 22 30 32 friedman.test(y) #&gt; #&gt; Friedman rank sum test #&gt; #&gt; data: y #&gt; Friedman chi-squared = 21, df = 3, p-value = 1e-04 例5.6.2 Page检验： x &lt;- c(40,52,80,52,76,100,34,52,51,35,53,65) x &lt;- matrix(x,3,4) page.test(x,alternative = &quot;increasing&quot;) #&gt; #&gt; Page test #&gt; #&gt; data: x #&gt; Page test statistic = 55, blocks = 4, treatments = 3, p-value = 0.007 #&gt; alternative hypothesis: increasing 例5.6.3 Cochran检验： x1 &lt;- c(rep(1,8),0,rep(1,5),0) x2 &lt;- c(1,rep(0,3),1,1,0,1,0,0,0,rep(1,4)) x3 &lt;- c(0,0,0,1,rep(0,7),1,0,0,0) x &lt;- matrix(as.logical(c(x1,x2,x3)),3,15,byrow = TRUE) cochran.test(x) #&gt; #&gt; Cochran test #&gt; #&gt; data: x #&gt; Cochran test statistic = 14, df = 2, blocks = 15, treatments = 3, #&gt; p-value = 9e-04 例5.6.4 Durbin检验： # 先构建矩阵，无实验数据用NA表示 A &lt;- c(3.5,2.9,3.7,NA) B &lt;- c(3.7,3.1,NA,4.4) C &lt;- c(4.1,NA,4.9,5.8) D &lt;- c(NA,4.5,5.7,5.9) x &lt;- matrix(c(A,B,C,D),ncol = 4) durbinTest(x) #&gt; #&gt; Durbin&#39;s rank sum test for a two-way #&gt; balanced incomplete block design #&gt; #&gt; data: x #&gt; Durbin chi-squared = 8, df = 3, p-value = 0.06 例5.7.1 Spearman秩相关检验： x &lt;- c(452,318,310,409,405,332,497,321,406,413,334,467) y &lt;- c(107,147,151,120,123,135,100,143,117,118,141,100) cor.test(x,y,alternative = &quot;two.sided&quot;,method = &quot;spearman&quot;,exact = F) #&gt; #&gt; Spearman&#39;s rank correlation rho #&gt; #&gt; data: x and y #&gt; S = 563, p-value = 2e-07 #&gt; alternative hypothesis: true rho is not equal to 0 #&gt; sample estimates: #&gt; rho #&gt; -0.97 例5.7.2 Kendall \\(\\tau\\)相关检验： x &lt;- c(86,78,65,88,90,90,80,77,76,68,85,70) y &lt;- c(71,69,62,78,82,75,73,65,66,60,70,61) cor.test(x,y,alternative = &quot;two.sided&quot;,method = &quot;kendall&quot;,exact = F) #&gt; #&gt; Kendall&#39;s rank correlation tau #&gt; #&gt; data: x and y #&gt; z = 4, p-value = 3e-04 #&gt; alternative hypothesis: true tau is not equal to 0 #&gt; sample estimates: #&gt; tau #&gt; 0.809 ？？？\\(p\\)值又跟书本不同。 例5.7.3 Kendall协同系数检验： # 先构建矩阵，列为评分机构 A &lt;- c(12,9,2,4,10,7,11,6,8,5,3,1) B &lt;- c(10,1,3,12,8,7,5,9,6,11,4,2) C &lt;- c(11,8,4,12,2,10,9,7,5,6,3,1) D &lt;- c(9,1,2,10,12,6,7,4,8,5,11,3) x &lt;- matrix(c(A,B,C,D),ncol = 4) KendallW(x,test = TRUE,correct = TRUE) #&gt; #&gt; Kendall&#39;s coefficient of concordance Wt #&gt; #&gt; data: x #&gt; Kendall chi-squared = 22, df = 11, subjects = 12, raters = 4, p-value = #&gt; 0.02 #&gt; alternative hypothesis: Wt is greater 0 #&gt; sample estimates: #&gt; Wt #&gt; 0.503 3.4 习题5 5.2 解： 对称中心检验问题： \\[ \\theta=320 \\qquad v.s. \\qquad \\theta&gt;320 \\] # 载入数据 x &lt;- c(310,350,370,375,385,400,415,425,440,295, 325,295,250,340,295,365,375,360,385) wilcox.test(x,alternative = &quot;greater&quot;,mu = 320,exact = FALSE) #&gt; #&gt; Wilcoxon signed rank test with continuity correction #&gt; #&gt; data: x #&gt; V = 158, p-value = 0.006 #&gt; alternative hypothesis: true location is greater than 320 \\(p\\)值小于0.05，应当拒绝原假设。 5.3 解： 对称中心检验问题： \\[ \\theta=10 \\qquad v.s. \\qquad \\theta\\ne 10 \\] （1）符号检验： d &lt;- c(22,9,4,5,1,16,15,26,47,8,31,7) x &lt;- 10 S1 = sum(d&lt;x) S2 = sum(d&gt;x) S0 = sum(d==x) binom.test(x = S1,n = S1+S2,p = 0.5,alternative = &quot;two.sided&quot;) #&gt; #&gt; Exact binomial test #&gt; #&gt; data: S1 and S1 + S2 #&gt; number of successes = 6, number of trials = 12, p-value = 1 #&gt; alternative hypothesis: true probability of success is not equal to 0.5 #&gt; 95 percent confidence interval: #&gt; 0.211 0.789 #&gt; sample estimates: #&gt; probability of success #&gt; 0.5 \\(p\\)值巨大，应当接受原假设。 （2）Wilcoxon符号秩检验： wilcox.test(d,alternative = &quot;two.sided&quot;,mu = x,exact = FALSE) #&gt; #&gt; Wilcoxon signed rank test with continuity correction #&gt; #&gt; data: d #&gt; V = 53, p-value = 0.3 #&gt; alternative hypothesis: true location is not equal to 10 \\(p\\)值大于0.05也是接受原假设，但\\(p\\)值相对于符号检验要小很多。 5.4 解： 成对数据的检验，采用Wilcoxon符号秩检验。 \\[ E(D)=0\\qquad v.s. \\qquad E(D)\\ne 0 \\] x &lt;- c(78,70,67,81,76,72,85,83) y &lt;- c(62,58,63,77,80,73,82,78) w &lt;- wilcox.test(x,y,mu = 0,alternative = &quot;two.sided&quot;,paired = TRUE) #&gt; Warning in wilcox.test.default(x, y, mu = 0, alternative = &quot;two.sided&quot;, : cannot #&gt; compute exact p-value with ties w #&gt; #&gt; Wilcoxon signed rank test with continuity correction #&gt; #&gt; data: x and y #&gt; V = 31, p-value = 0.08 #&gt; alternative hypothesis: true location shift is not equal to 0 有打结： t &lt;- table(rank(abs(x-y))) t[t&gt;1] #&gt; 4 #&gt; 3 只有1个结，长度为3.本来写好了一个函数用于修正统计量，但是扒了源代码发现关于打结的修正依旧包含在函数中了，只是当样本数少于50或打结时会出现提醒.可以利用命令查看源代码： stats:::wilcox.test.default 所以在显著性水平0.05下仍然接受原假设，即认为幼儿园生活对孩子的社会知识没有影响。 5.5 解： 成对数据的检验，采用Wilcoxon符号秩检验。 \\[ E(D)=0\\qquad v.s. \\qquad E(D)\\ne 0 \\] x &lt;- c(1149,1152,1176,1149,1155,1169,1182,1160,1129,1171) y &lt;- c(1116,1130,1184,1194,1184,1147,1125,1125,1166,1151) wilcox.test(x,y,alternative = &quot;two.sided&quot;,mu = 0,paired = TRUE) #&gt; Warning in wilcox.test.default(x, y, alternative = &quot;two.sided&quot;, mu = 0, : cannot #&gt; compute exact p-value with ties #&gt; #&gt; Wilcoxon signed rank test with continuity correction #&gt; #&gt; data: x and y #&gt; V = 32, p-value = 0.7 #&gt; alternative hypothesis: true location shift is not equal to 0 在显著性水平0.05下，接受原假设，即认为这段时间的股票指数的波动程度相同。 5.6 解： 位置参数的检验： \\[ \\delta=0\\qquad v.s\\qquad \\delta\\ne 0 \\] 采用Wilcoxon秩和检验： x &lt;- c(134,146,104,119,124,161,112,83,113,129,97,123) y &lt;- c(70,118,101,85,107,132,94) wilcox.test(x,y,alternative = &quot;two.sided&quot;,mu = 0,paired = FALSE) # paired = FALSE #&gt; #&gt; Wilcoxon rank sum test #&gt; #&gt; data: x and y #&gt; W = 63, p-value = 0.08 #&gt; alternative hypothesis: true location shift is not equal to 0 在显著性水平0.05下应当接受原假设，即认为两种饲料对雌鼠的体重增加的影响不显著。 5.7 解： 位置参数的检验： \\[ \\delta=0\\qquad v.s\\qquad \\delta\\ne 0 \\] 采用Wilcoxon秩和检验： x &lt;- c(52,49,54,47,56,55,45,57,55,54) y &lt;- c(49,48,39,44,40,50,36,41) wilcox.test(x,y,alternative = &quot;two.sided&quot;,mu = 0,paired = FALSE) #&gt; Warning in wilcox.test.default(x, y, alternative = &quot;two.sided&quot;, mu = 0, : cannot #&gt; compute exact p-value with ties #&gt; #&gt; Wilcoxon rank sum test with continuity correction #&gt; #&gt; data: x and y #&gt; W = 72, p-value = 0.004 #&gt; alternative hypothesis: true location shift is not equal to 0 在显著性水平0.05下应当拒绝原假设，即认为这两个厂产品的寿命不同。 5.8 解： 先载入数据： x &lt;- c(56,105,63,88,72,112,96,93,65,105,94,87,64,65,68,87) y &lt;- c(88,94,93,96,99,79,91,94,91,100,99,90,100,110,102,95) 1.成对数据的检验： wilcox.test(x,y,mu = 0,alternative = &quot;two.sided&quot;,paired = TRUE) #&gt; Warning in wilcox.test.default(x, y, mu = 0, alternative = &quot;two.sided&quot;, : cannot #&gt; compute exact p-value with ties #&gt; #&gt; Wilcoxon signed rank test with continuity correction #&gt; #&gt; data: x and y #&gt; V = 29, p-value = 0.05 #&gt; alternative hypothesis: true location shift is not equal to 0 2.位置参数的检验： wilcox.test(x,y,mu = 0,alternative = &quot;two.sided&quot;,paired = FALSE) #&gt; Warning in wilcox.test.default(x, y, mu = 0, alternative = &quot;two.sided&quot;, : cannot #&gt; compute exact p-value with ties #&gt; #&gt; Wilcoxon rank sum test with continuity correction #&gt; #&gt; data: x and y #&gt; W = 72, p-value = 0.03 #&gt; alternative hypothesis: true location shift is not equal to 0 3.尺度参数的检验： mood.test(x,y,alternative = &quot;two.sided&quot;) #&gt; #&gt; Mood two-sample test of scale #&gt; #&gt; data: x and y #&gt; Z = 2, p-value = 0.02 #&gt; alternative hypothesis: two.sided square_rank.test(x,y,alternative = &quot;two.sided&quot;) #&gt; #&gt; Square rank test (with ties) #&gt; #&gt; data: x and y #&gt; square rank test statistic = 4, the number of x = 16, the number of y = #&gt; 16, the number of x and y = 32, p-value = 3e-04 #&gt; alternative hypothesis: two.sided 综上，可以看到在显著性水平0.05下，应当认为两个学科的博士论文页数有显著差异，人均页数显著不同，页数离散程度显著不同。 5.9 解： 先载入数据： x &lt;- c(83,79,83,74,75,74,86,76,84,73,78,77,80,83,78) y &lt;- c(75,62,58,89,77,81,27,85,72,85,74,100,43,52,75) 1.成对数据的检验： wilcox.test(x,y,mu = 0,alternative = &quot;two.sided&quot;,paired = TRUE) #&gt; Warning in wilcox.test.default(x, y, mu = 0, alternative = &quot;two.sided&quot;, : cannot #&gt; compute exact p-value with ties #&gt; #&gt; Wilcoxon signed rank test with continuity correction #&gt; #&gt; data: x and y #&gt; V = 82, p-value = 0.2 #&gt; alternative hypothesis: true location shift is not equal to 0 2.位置参数的检验： wilcox.test(x,y,mu = 0,alternative = &quot;two.sided&quot;,paired = FALSE) #&gt; Warning in wilcox.test.default(x, y, mu = 0, alternative = &quot;two.sided&quot;, : cannot #&gt; compute exact p-value with ties #&gt; #&gt; Wilcoxon rank sum test with continuity correction #&gt; #&gt; data: x and y #&gt; W = 142, p-value = 0.2 #&gt; alternative hypothesis: true location shift is not equal to 0 3.尺度参数的检验： mood.test(x,y,alternative = &quot;two.sided&quot;) #&gt; #&gt; Mood two-sample test of scale #&gt; #&gt; data: x and y #&gt; Z = -3, p-value = 0.007 #&gt; alternative hypothesis: two.sided square_rank.test(x,y,alternative = &quot;two.sided&quot;) #&gt; #&gt; Square rank test (with ties) #&gt; #&gt; data: x and y #&gt; square rank test statistic = -3, the number of x = 15, the number of y #&gt; = 15, the number of x and y = 30, p-value = 5e-04 #&gt; alternative hypothesis: two.sided 综上，可以看到在显著性水平0.05下，应当认为两个学校的学生成绩没有显著差异，平均成绩没有显著不同，离散程度有显著不同。 5.10 解： 可以考虑尺度参数的双边检验，方差比较低说明加工精度比较高。 x &lt;- c(18.0,17.1,16.4,16.9,16.9,16.7,16.7,17.2,17.5,16.9) y &lt;- c(17.0,16.9,17.0,16.9,17.2,17.1,16.8,17.1,17.1,16.2) Mood检验： mood.test(x,y,alternative = &quot;two.sided&quot;) #&gt; #&gt; Mood two-sample test of scale #&gt; #&gt; data: x and y #&gt; Z = 2, p-value = 0.1 #&gt; alternative hypothesis: two.sided 平方秩检验： square_rank.test(x,y,alternative = &quot;two.sided&quot;) #&gt; #&gt; Square rank test (with ties) #&gt; #&gt; data: x and y #&gt; square rank test statistic = 1, the number of x = 10, the number of y = #&gt; 10, the number of x and y = 20, p-value = 0.2 #&gt; alternative hypothesis: two.sided \\(p\\)值都大于0.05，应当接受原假设，即认为他们的水平（加工精度）一致。 5.11 解： 尺度参数的双边检验。 x &lt;- c(8.8,8.2,5.6,4.9,8.9,4.2,3.6,7.1,5.5,8.6,6.3,3.9) y &lt;- c(13.0,14.5,22.8,20.7,19.6,18.4,21.3,24.2,19.6,11.7) Mood检验： mood.test(x,y,alternative = &quot;two.sided&quot;) #&gt; #&gt; Mood two-sample test of scale #&gt; #&gt; data: x and y #&gt; Z = -0.5, p-value = 0.6 #&gt; alternative hypothesis: two.sided 平方秩检验： square_rank.test(x,y,alternative = &quot;two.sided&quot;) #&gt; #&gt; Square rank test (with ties) #&gt; #&gt; data: x and y #&gt; square rank test statistic = -2, the number of x = 12, the number of y #&gt; = 10, the number of x and y = 22, p-value = 0.03 #&gt; alternative hypothesis: two.sided 在显著性水平0.05下，mood检验表示应当接受原假设，而平方秩检验表示应当拒绝原假设。 但是mood检验需要要求两总体位置参数相等，利用位置参数的检验： wilcox.test(x,y,alternative = &quot;two.sided&quot;,mu = 0,paired = FALSE) #&gt; Warning in wilcox.test.default(x, y, alternative = &quot;two.sided&quot;, mu = 0, : cannot #&gt; compute exact p-value with ties #&gt; #&gt; Wilcoxon rank sum test with continuity correction #&gt; #&gt; data: x and y #&gt; W = 0, p-value = 9e-05 #&gt; alternative hypothesis: true location shift is not equal to 0 \\(p\\)值很小，应当拒绝原假设，即认为两总体的位置参数不等。为了使用mood检验，我们需要估计两总体位置参数，进而平移使他们相等。 # 平移两组样本 x1 &lt;- x-mean(x) y1 &lt;- y-mean(y) # 再进行mood检验 mood.test(x1,y1,alternative = &quot;two.sided&quot;) #&gt; #&gt; Mood two-sample test of scale #&gt; #&gt; data: x1 and y1 #&gt; Z = -2, p-value = 0.04 #&gt; alternative hypothesis: two.sided \\(p\\)值小于0.05，应当拒绝原假设。综上，应当认为两组数据的方差存在差异。 5.12 解： 尺度参数的双边检验。 x &lt;- c(8.2,10.7,7.5,14.6,6.3,9.2,11.9,5.6,12.8,5.2,4.9,13.5) y &lt;- c(4.7,6.3,5.2,6.8,5.6,4.2,6.0,7.4,8.1,6.5) 先进行位置参数的检验： wilcox.test(x,y,alternative = &quot;two.sided&quot;,mu = 0,paired = FALSE) #&gt; Warning in wilcox.test.default(x, y, alternative = &quot;two.sided&quot;, mu = 0, : cannot #&gt; compute exact p-value with ties #&gt; #&gt; Wilcoxon rank sum test with continuity correction #&gt; #&gt; data: x and y #&gt; W = 92, p-value = 0.03 #&gt; alternative hypothesis: true location shift is not equal to 0 应当拒绝原假设，即认为他们的位置参数不相等。平移数据后再进行mood检验： # 平移两组样本 x1 &lt;- x-mean(x) y1 &lt;- y-mean(y) # 再进行mood检验 mood.test(x1,y1,alternative = &quot;two.sided&quot;) #&gt; #&gt; Mood two-sample test of scale #&gt; #&gt; data: x1 and y1 #&gt; Z = 3, p-value = 0.004 #&gt; alternative hypothesis: two.sided 平方秩检验： square_rank.test(x,y,alternative = &quot;two.sided&quot;) #&gt; Warning in square_rank.test(x, y, alternative = &quot;two.sided&quot;): The sizes of x and #&gt; y are less than 10. The test may be inaccurate. #&gt; #&gt; Square rank test #&gt; #&gt; data: x and y #&gt; square rank test statistic = 3110, the number of x = 12, the number of #&gt; y = 10, the number of x and y = 22, p-value = 1e-04 #&gt; alternative hypothesis: two.sided 两个检验都表明应当拒绝原假设，即认为他们的尿酸浓度变异不相同。 5.13 解： 关于位置参数的多样本双边检验问题。 A &lt;- c(80,203,236,252,284,368,457,393) B &lt;- c(133,180,100,160) C &lt;- c(156,295,320,448,465,481,279) D &lt;- c(194,214,272,330,386,475) x &lt;- list(A,B,C,D) Kruskal-Waillis检验： kruskal.test(x) #&gt; #&gt; Kruskal-Wallis rank sum test #&gt; #&gt; data: x #&gt; Kruskal-Wallis chi-squared = 8, df = 3, p-value = 0.04 在显著性水平0.05下应当拒绝原假设，即认为这四种药物的治疗效果不同。 5.14 解： 关于位置参数的多样本双边检验问题。 A &lt;- c(830,910,940,890,890,960,910,920,900) B &lt;- c(910,900,810,830,840,830,880,910,890,840) C &lt;- c(1010,1000,910,930,960,950,940) D &lt;- c(780,820,810,770,790,810,800,810) x &lt;- list(A,B,C,D) kruskal.test(x) #&gt; #&gt; Kruskal-Wallis rank sum test #&gt; #&gt; data: x #&gt; Kruskal-Wallis chi-squared = 26, df = 3, p-value = 1e-05 \\(p\\)值很小，应当拒绝原假设，即认为每种培育方法的水稻产量不相同。为了比较任意两种方法的水稻产量之间的差异，需要用的Dunn检验： DunnTest(x) #&gt; #&gt; Dunn&#39;s test of multiple comparisons using rank sums : holm #&gt; #&gt; mean.rank.diff pval #&gt; 2-1 -6.53 0.2438 #&gt; 3-1 7.74 0.2438 #&gt; 4-1 -17.02 0.0021 ** #&gt; 3-2 14.27 0.0141 * #&gt; 4-2 -10.49 0.0778 . #&gt; 4-3 -24.76 8.6e-06 *** #&gt; --- #&gt; Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 在显著性水平0.05下，方法4跟方法1、方法3跟方法2、方法4跟方法3的水稻产量有显著差异。 5.15 关于位置参数的多样本趋势性检验问题。 采用Jonckheere-Terpstra检验： A &lt;- c(125,136,116,101,105,109) B &lt;- c(122,114,132,120,119,127) C &lt;- c(128,142,128,134,135,132,140,129) x &lt;- list(A,B,C) k &lt;- length(x) l &lt;- sapply(x,length) g &lt;-ordered(rep(1:k, l)) x &lt;- unlist(x) JonckheereTerpstraTest(x,g) #&gt; Warning in JonckheereTerpstraTest.default(x, g): Sample size &gt; 100 or data with ties #&gt; p-value based on normal approximation. Specify nperm for permutation p-value #&gt; #&gt; Jonckheere-Terpstra test #&gt; #&gt; data: x and g #&gt; JT = 112, p-value = 0.002 #&gt; alternative hypothesis: two.sided \\(p\\)值小于显著性水平0.05，应当拒绝原假设，即认为结论可靠。 5.16 解： 关于位置参数的多样本趋势性检验问题。 采用Jonckheere-Terpstra检验： A &lt;- c(40,35,38,43,44,41) B &lt;- c(38,40,47,44,40,42) C &lt;- c(48,40,45,43,46,48,44) x &lt;- list(A,B,C) k &lt;- length(x) l &lt;- sapply(x,length) g &lt;-ordered(rep(1:k, l)) x &lt;- unlist(x) JonckheereTerpstraTest(x,g) #&gt; Warning in JonckheereTerpstraTest.default(x, g): Sample size &gt; 100 or data with ties #&gt; p-value based on normal approximation. Specify nperm for permutation p-value #&gt; #&gt; Jonckheere-Terpstra test #&gt; #&gt; data: x and g #&gt; JT = 91, p-value = 0.02 #&gt; alternative hypothesis: two.sided \\(p\\)值小于显著性水平0.05，应当拒绝原假设，即认为研究者的经验可靠。 5.17 解： 完全区组设计的Friedman检验： A &lt;- c(73,75,67,61,69,79) B &lt;- c(83,81,99,82,85,87) C &lt;- c(73,60,73,77,68,74) D &lt;- c(58,64,64,71,77,74) E &lt;- c(77,75,73,59,85,82) y &lt;- matrix(c(A,B,C,D,E),ncol = 5) friedman.test(y) #&gt; #&gt; Friedman rank sum test #&gt; #&gt; data: y #&gt; Friedman chi-squared = 15, df = 4, p-value = 0.006 \\(p\\)值小于显著性水平0.05，应当拒绝原假设，即认为面积大小有差异。 5.18 解： 二元区组设计的Cochran检验： A &lt;- c(rep(1,9),0) B &lt;- c(1,1,0,1,0,1,0,0,1,1) C &lt;- c(0,0,1,1,0,0,0,0,0,1) x &lt;- as.logical(c(A,B,C)) x &lt;- matrix(x,nrow = 3,byrow = TRUE) cochran.test(x) #&gt; #&gt; Cochran test #&gt; #&gt; data: x #&gt; Cochran test statistic = 6, df = 2, blocks = 10, treatments = 3, #&gt; p-value = 0.05 \\(p\\) 值略小于显著性水平0.05，应当拒绝原假设，即认为顾客对这三种糕点的爱好并不相同。 5.19 解： 完全区组设计的Page检验，单调上升： x1 &lt;- c(36,51,71,63,82,128) x2 &lt;- c(62,91,40,51,33,81) x3 &lt;- c(53,81,67,75,116,38) x4 &lt;- c(105,63,49,65,107,33) x5 &lt;- c(36,46,62,63,42,104) x6 &lt;- c(118,65,126,96,122,112) x7 &lt;- c(42,108,123,32,69,102) x8 &lt;- c(51,63,55,86,41,121) x9 &lt;- c(114,51,30,109,97,86) x &lt;- matrix(c(x1,x2,x3,x4,x5,x6,x7,x8,x9),ncol=9) page.test(x,alternative = &quot;increasing&quot;) #&gt; #&gt; Page test #&gt; #&gt; data: x #&gt; Page test statistic = 685, blocks = 9, treatments = 6, p-value = 0.2 #&gt; alternative hypothesis: increasing \\(p\\)值大于显著性水平0.05，应当接受原假设，即认为论断不正确。 或者利用DescTools的PageTest函数： PageTest(t(x)) #&gt; #&gt; Page test for ordered alternatives #&gt; #&gt; data: t(x) #&gt; L = 685, p-value = 0.2 \\(p\\)值相差不大。 5.20 解： 平衡的不完全区组设计的Durbin检验： A &lt;- c(73,74,NA,71) B &lt;- c(NA,75,67,72) C &lt;- c(74,75,68,NA) D &lt;- c(75,NA,72,75) x &lt;- matrix(c(A,B,C,D),ncol = 4) durbinTest(x) #&gt; #&gt; Durbin&#39;s rank sum test for a two-way #&gt; balanced incomplete block design #&gt; #&gt; data: x #&gt; Durbin chi-squared = 7, df = 3, p-value = 0.06 \\(p\\)值大于显著性水平0.05，应当接受原假设，即认为四种饲料的品质无差别。 5.21 解： 相关分析： # 载入数据 x &lt;- c(65,89,67,66,89,85,84,73,88,80,86,75) y &lt;- c(62,66,50,68,88,86,64,62,92,64,81,80) 三类相关检验： cor.test(x,y,alternative = &quot;two.sided&quot;,method = &quot;spearman&quot;,exact = F) #&gt; #&gt; Spearman&#39;s rank correlation rho #&gt; #&gt; data: x and y #&gt; S = 90, p-value = 0.01 #&gt; alternative hypothesis: true rho is not equal to 0 #&gt; sample estimates: #&gt; rho #&gt; 0.685 cor.test(x,y,alternative = &quot;two.sided&quot;,method = &quot;kendall&quot;,exact = F) #&gt; #&gt; Kendall&#39;s rank correlation tau #&gt; #&gt; data: x and y #&gt; z = 2, p-value = 0.02 #&gt; alternative hypothesis: true tau is not equal to 0 #&gt; sample estimates: #&gt; tau #&gt; 0.543 Spearman秩相关检验以及Kendall \\(\\tau\\) 检验都表明在显著性水平0.05下应当拒绝原假设，即认为两者具有相关关系。 cor.test(x,y,alternative = &quot;two.sided&quot;,method = &quot;pearson&quot;) #&gt; #&gt; Pearson&#39;s product-moment correlation #&gt; #&gt; data: x and y #&gt; t = 3, df = 10, p-value = 0.02 #&gt; alternative hypothesis: true correlation is not equal to 0 #&gt; 95 percent confidence interval: #&gt; 0.118 0.891 #&gt; sample estimates: #&gt; cor #&gt; 0.648 \\(p\\)值小于显著性水平0.05，应当拒绝原假设，即应当认为两者具有线性相关关系。 5.22 解： 相关分析： # 载入数据 x &lt;- c(75,95,85,70,76,68,60,66,80,88) y &lt;- c(2.62,2.91,2.94,2.11,2.17,1.98,2.04,2.20,2.65,2.69) 三类相关检验： cor.test(x,y,alternative = &quot;two.sided&quot;,method = &quot;spearman&quot;,exact = F) #&gt; #&gt; Spearman&#39;s rank correlation rho #&gt; #&gt; data: x and y #&gt; S = 26, p-value = 0.002 #&gt; alternative hypothesis: true rho is not equal to 0 #&gt; sample estimates: #&gt; rho #&gt; 0.842 cor.test(x,y,alternative = &quot;two.sided&quot;,method = &quot;kendall&quot;,exact = F) #&gt; #&gt; Kendall&#39;s rank correlation tau #&gt; #&gt; data: x and y #&gt; z = 3, p-value = 0.006 #&gt; alternative hypothesis: true tau is not equal to 0 #&gt; sample estimates: #&gt; tau #&gt; 0.689 Spearman秩相关检验以及Kendall \\(\\tau\\) 检验都表明在显著性水平0.05下应当拒绝原假设，即认为两者具有相关关系。 cor.test(x,y,alternative = &quot;two.sided&quot;,method = &quot;pearson&quot;) #&gt; #&gt; Pearson&#39;s product-moment correlation #&gt; #&gt; data: x and y #&gt; t = 5, df = 8, p-value = 8e-04 #&gt; alternative hypothesis: true correlation is not equal to 0 #&gt; 95 percent confidence interval: #&gt; 0.558 0.971 #&gt; sample estimates: #&gt; cor #&gt; 0.879 \\(p\\)值小于显著性水平0.05，应当拒绝原假设，即应当认为两者具有线性相关关系。 5.23 解： Kendall协同系数检验： A &lt;- c(9,2,4,10,7,6,8,5,3,1) B &lt;- c(10,1,3,8,7,5,9,6,4,2) C &lt;- c(8,4,2,10,9,7,5,6,3,1) D &lt;- c(9,1,2,10,6,7,4,8,5,3) x &lt;- matrix(c(A,B,C,D),ncol = 4) KendallW(x,test = TRUE,correct = TRUE) #&gt; #&gt; Kendall&#39;s coefficient of concordance Wt #&gt; #&gt; data: x #&gt; Kendall chi-squared = 31, df = 9, subjects = 10, raters = 4, p-value = #&gt; 3e-04 #&gt; alternative hypothesis: Wt is greater 0 #&gt; sample estimates: #&gt; Wt #&gt; 0.853 \\(p\\)值很小，应当拒绝原假设，即认为这些排序产生较为一致的效果。 5.24 解： 线性相关分析： x &lt;- c(58.8,61.4,71.3,74.4,76.7,70.7,57.5,46.4,39.1,48.5,70.0,70.1) y &lt;- c(8.4,9.27,8.73,6.36,8.50,7.82,9.14,8.24,9.57,9.58,8.11,6.83) cor.test(x,y,alternative = &quot;two.sided&quot;,method = &quot;pearson&quot;) #&gt; #&gt; Pearson&#39;s product-moment correlation #&gt; #&gt; data: x and y #&gt; t = -3, df = 10, p-value = 0.03 #&gt; alternative hypothesis: true correlation is not equal to 0 #&gt; 95 percent confidence interval: #&gt; -0.8822 -0.0789 #&gt; sample estimates: #&gt; cor #&gt; -0.625 \\(p\\)值小于显著性水平0.05，应当拒绝原假设，即认为两者存在线性关系。 "],["test-eff.html", "4 检验的功效与渐进相对效率 4.1 检验的功效", " 4 检验的功效与渐进相对效率 先载入一些包： library(tidyverse) 4.1 检验的功效 利用统计模拟的方法，比较单样本位置检验中不同检验方法的功效。 4.1.1 假设检验问题 随机变量\\(X_1,\\cdots,X_n\\)是来自连续分布总体\\(F(x-\\theta)\\)的样本，函数\\(F(t)\\)关于0点对称。检验假设： \\[ H_0:\\theta=0\\qquad v.s. \\qquad H_1:\\theta&gt;0 \\] 4.1.2 检验方法 T检验。检验统计量为： \\[ T=\\frac{\\bar X}{S/\\sqrt{n}} \\] 其中，\\(\\bar X\\)为样本均值，\\(S\\)为样本标准差。拒绝域为\\(T\\ge t_{n-1}(1-\\alpha)\\) 符号检验。检验统计量为： \\[ S^+ = \\sum_{i=1}^n\\psi(X_i) \\] 拒绝域为\\(S^+\\ge b(1-\\alpha,n)\\). 符号秩检验。检验统计量为： \\[ W^+ = \\sum_{i=1}^n\\psi(X_i)R_i^+ \\] 拒绝域为\\(W^+\\ge w(1-\\alpha,n)\\)。 4.1.3 实验分布 选择典型的常用对称分布，分别为[-1,1]上均匀分布、正态分布、Logistics分布、Cauchy分布。 ggplot()+ geom_function(aes(colour = &quot;unif&quot;),fun = dunif,args = list(min=-1,max=1))+ geom_function(aes(colour = &quot;norm&quot;),fun = dnorm)+ geom_function(aes(colour = &quot;logistic&quot;),fun = dlogis)+ geom_function(aes(colour = &quot;cauchy&quot;),fun = dcauchy)+ lims(x=c(-4,4))+ ggtitle(&quot;各分布密度函数图&quot;) 4.1.4 统计模拟 一些预定参数： 对固定分布\\((\\theta,F)\\)产生样本值1000次，每次100个样本； 显著性水平\\(\\alpha\\)取0.05。 # 定义带参数的均匀分布作为新函数 runif_new &lt;- function(n){ runif(n,min = -1,max = 1) } # 检验功效函数 testpower &lt;- function(theta,funcs,n=100,times=1000,alpha=0.05){ library(tidyverse) s &lt;- funcs(n*times)+theta # 产生样本 s &lt;- matrix(s,nrow = times) # 每行为一组样本 # T检验功效 p &lt;- apply(s,1,t.test,alternative = &quot;greater&quot;) %&gt;% map(~.$p.value) %&gt;% unlist() pt &lt;- mean(p&lt;alpha) # 符号检验 # 求大于0个数 postn &lt;- function(x){ sum(x&gt;0) } # 求等于0个数 zeron &lt;- function(x){ sum(x==0) } s1 &lt;- apply(s,1,postn) s2 &lt;- apply(s,1,zeron) p &lt;- map2(s1,n-s2,binom.test,p = 0.5,alternative = &quot;greater&quot;) %&gt;% map(~.$p.value) %&gt;% unlist() ps &lt;- mean(p&lt;alpha) # 符号秩检验 p &lt;- apply(s,1,wilcox.test,alternative = &quot;greater&quot;,mu=0) %&gt;% map(~.$p.value) %&gt;% unlist() pw &lt;- mean(p&lt;alpha) l &lt;- list(pt=pt,ps=ps,pw=pw) l } 对均匀分布： theta &lt;- seq(0,0.7,by = 0.1) map(theta,testpower,funcs=runif_new)-&gt;ln df &lt;- data.frame(matrix(unlist(ln), ncol=3,byrow = TRUE)) df %&gt;% rename(pt=X1,ps=X2,pw=X3) %&gt;% ggplot(aes(x=theta))+ geom_line(aes(y=pt,color=&quot;T检验&quot;))+ geom_line(aes(y=ps,color=&quot;符号检验&quot;))+ geom_line(aes(y=pw,color=&quot;符号秩检验&quot;))+ labs(title = &quot;均匀分布&quot;,y=&quot;功效&quot;,color=&quot;检验方法&quot;) T检验方法比符号秩检验方法稍好，符号检验方法较差。 对正态分布： theta &lt;- seq(0,0.8,by = 0.1) map(theta,testpower,funcs=rnorm)-&gt;ln df &lt;- data.frame(matrix(unlist(ln), ncol=3,byrow = TRUE)) df %&gt;% rename(pt=X1,ps=X2,pw=X3) %&gt;% ggplot(aes(x=theta))+ geom_line(aes(y=pt,color=&quot;T检验&quot;))+ geom_line(aes(y=ps,color=&quot;符号检验&quot;))+ geom_line(aes(y=pw,color=&quot;符号秩检验&quot;))+ labs(title = &quot;正态分布&quot;,y=&quot;功效&quot;,color=&quot;检验方法&quot;) T检验方法比符号秩检验方法稍好，符号检验方法较差。 对Logistics分布： theta &lt;- seq(0,1.5,by = 0.1) map(theta,testpower,funcs=rlogis)-&gt;ln df &lt;- data.frame(matrix(unlist(ln), ncol=3,byrow = TRUE)) df %&gt;% rename(pt=X1,ps=X2,pw=X3) %&gt;% ggplot(aes(x=theta))+ geom_line(aes(y=pt,color=&quot;T检验&quot;))+ geom_line(aes(y=ps,color=&quot;符号检验&quot;))+ geom_line(aes(y=pw,color=&quot;符号秩检验&quot;))+ labs(title = &quot;Logistic分布&quot;,y=&quot;功效&quot;,color=&quot;检验方法&quot;) 三种检验方法比较接近，符号秩检验方法稍好。 对Cauchy分布： theta &lt;- seq(0,1.5,by = 0.1) map(theta,testpower,funcs=rcauchy)-&gt;ln df &lt;- data.frame(matrix(unlist(ln), ncol=3,byrow = TRUE)) df %&gt;% rename(pt=X1,ps=X2,pw=X3) %&gt;% ggplot(aes(x=theta))+ geom_line(aes(y=pt,color=&quot;T检验&quot;))+ geom_line(aes(y=ps,color=&quot;符号检验&quot;))+ geom_line(aes(y=pw,color=&quot;符号秩检验&quot;))+ labs(title = &quot;Cauchy分布&quot;,y=&quot;功效&quot;,color=&quot;检验方法&quot;) 符号检验方法较好，T检验方法很差。 所以，如果我们对\\(H_1\\)下的分布有一定的先验知识：峰度等，可以选择适宜的检验方法，也可以通过估计来粗略得到分布的峰度、偏度等等。 "]]
